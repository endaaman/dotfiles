import numpy as np
from sklearn import metrics as skmetrics


def plot_roc(trainer, ax, train_preds, train_gts, val_preds, val_gts):
    for t, preds, gts in (('train', train_preds, train_gts), ('val', val_preds, val_gts)):
        fpr, tpr, thresholds = skmetrics.roc_curve(gts, preds)
        auc = skmetrics.auc(fpr, tpr)
        ax.plot(fpr, tpr, label=f'{t} AUC:{auc:.3f}')
        if t == 'train':
            youden_index = np.argmax(tpr - fpr)
            threshold = thresholds[youden_index]
    ax.set_title(f'ROC (t={threshold:.2f})')
    ax.set_ylabel('Sensitivity')
    ax.set_xlabel('1 - Specificity')
    ax.legend(loc='lower right')
