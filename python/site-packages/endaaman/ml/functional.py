import torch
import numpy as np
from sklearn import metrics


def multi_accuracy(preds, gts, by_index=True):
    pred_label = np.argmax(preds, axis=1)
    if by_index:
        gts_label = gts
    else:
        gts_label = torch.argmax(gts, axis=1)
    correct = torch.sum(gts_label == pred_label)
    return correct / len(gts_label)
